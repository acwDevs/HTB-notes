

| `Exchange Windows Permissions`                                                                                  | Not listed as a protected group, but members are granted the ability to write a DACL to the domain object                                                                                                                                                                                                 | This can be leveraged to give a user DCSync privileges. An attacker can add accounts to this group by leveraging a DACL misconfiguration (possible) or by leveraging a compromised account that is a member of the Account Operators group. [Techniques](https://github.com/gdedrouas/Exchange-AD-Privesc)                                                                                                            |
| --------------------------------------------------------------------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `Organization Management`                                                                                       | Can access the mailboxes of all domain users. Has full control of the OU called `Microsoft Exchange Security Groups`, which contains the group `Exchange Windows Permissions`                                                                                                                             | This group also has full control of the OU called `Microsoft Exchange Security Groups`, which contains the group `Exchange Windows Permissions`                                                                                                                                                                                                                                                                       |
| `PrivExchange Attack`                                                                                           | Flaw in the Exchange Server `PushSubscription` feature, which allows any domain user with a mailbox to force the Exchange server to authenticate to any host provided by the client over HTTP                                                                                                             | The Exchange service runs as SYSTEM and has WriteDACL. This flaw can be leveraged to relay to LDAP and dump the domain NTDS database. If we cannot relay to LDAP, this can be leveraged to relay and authenticate to other hosts within the domain. This attack will take you directly to Domain Admin with any authenticated domain user account.                                                                    |
| `Printer Bug` [Testing Link](https://github.com/NotMedic/NetNTLMtoSilverTicket/blob/master/Get-SpoolStatus.ps1) | Flaw in the MS-RPRN protocol (Print System Remote Protocol). Any domain user can connect to the spool's named pipe with the `RpcOpenPrinter` method and use the `RpcRemoteFindFirstPrinterChangeNotificationEx` method, and force the server to authenticate to any host provided by the client over SMB. | This attack can be leveraged to relay to LDAP and grant your attacker account DCSync privileges to retrieve all password hashes from AD. The attack can also be used to relay LDAP authentication and grant Resource-Based Constrained Delegation (RBCD) privileges for the victim to a computer account under our control, thus giving the attacker privileges to authenticate as any user on the victim's computer. |
| `GPO misconfigurations`                                                                                         | - Adding additional rights to a user (such as SeDebugPrivilege, SeTakeOwnershipPrivilege, or SeImpersonatePrivilege)<br>- Adding a local admin user to one or more hosts<br>- Creating an immediate scheduled task to perform any number of actions                                                       |                                                                                                                                                                                                                                                                                                                                                                                                                       |
